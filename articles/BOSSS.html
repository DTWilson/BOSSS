<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>BOSSS • BOSSS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BOSSS">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BOSSS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/BOSSS.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Examples.html">Examples</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>BOSSS</h1>
            
      

      <div class="d-none name"><code>BOSSS.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dtwilson.github.io/BOSSS/">BOSSS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/olafmersmann/mco" class="external-link">mco</a></span><span class="op">)</span></span></code></pre></div>
<!-- Note - a Twitter thread on power analysis had a couple of people mentioning the R package simr for power through simulation when using mixed models. So might be worth including that in one of our examples, to save people having to write their own simulation code? -->
<p>Every application of BOSSS follows the same set of steps:</p>
<ol style="list-style-type: decimal">
<li>Formally specify the problem and create a corresponding
<code>BOSSS_problem</code> object;</li>
<li>Create a <code>BOSSS_solution</code> object and initialise it;</li>
<li>Perform a number of iterations, each one updating and (hopefully)
improving the <code>BOSSS_solution</code> object;</li>
<li>Select a final design and run some diagnostics to check it is
valid.</li>
</ol>
<p>We will work through these steps here for an example problem:
designing a cluster randomised trial, as discussed in Section 2 of the
manuscript associated with the package. For more illustrations, see the
article.</p>
<div class="section level3">
<h3 id="problem">Problem<a class="anchor" aria-label="anchor" href="#problem"></a>
</h3>
<p>The first ingredient of a BOSSS problem is the simulation function.
The arguments of this function must first specify the <em>design
variables</em> which we want to vary in our problem, followed by the
<em>model parameters</em>. In this example we have two design variables
representing the number of clusters in each arm, and the number of
participants in each arm. The model parameters are the mean difference
in outcome between the control and experimental arms
(<code>beta_1</code>), the within-cluster variance (<code>var_e</code>),
and the between-cluster variance (<code>var_u</code>). Note that all of
these inputs require some defaults to be provided.</p>
<p>The other element of interface the simulation function must conform
to is in its return value, which should be a named vector of the
quantities who’s mean values we want to estimate using the Monte Carlo
method. Here, we have one such quantity: a boolean indicator of a
negative decision, <code>s</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_cRCT</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">20</span>, </span>
<span>                     <span class="va">beta_1</span> <span class="op">=</span> <span class="fl">0.3</span>, <span class="va">var_e</span> <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">var_u</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>; <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">m</span><span class="op">)</span> </span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">m</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_u</span> <span class="op">+</span> <span class="va">var_e</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">+</span> <span class="va">x</span><span class="op">*</span><span class="va">beta_1</span></span>
<span></span>
<span>  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">x</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="va">x</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&gt;</span> <span class="fl">0.025</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>s <span class="op">=</span> <span class="va">s</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># For example,</span></span>
<span><span class="fu">sim_cRCT</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     s </span></span>
<span><span class="co">#&gt; FALSE</span></span></code></pre></div>
<p>In our problem we are not just interested in the expected value of
<code>s</code>; we also want to minimise the number of clusters and the
number of participants. Since these are fixed quantities given any
design, we evaluate them in a separate deterministic function. This
should conform to the same principles as the simulation function, with
the same inputs, but allowing for different named outputs. Here, the
outputs are just <code>m</code>, and <code>N = n*m</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">det_cRCT</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                     <span class="va">beta_1</span> <span class="op">=</span> <span class="fl">0.3</span>, <span class="va">var_e</span> <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">var_u</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span>  </span></code></pre></div>
<p>Next, we need to note the ranges of the design variables which we
plan to search over. We use the <code><a href="../reference/design_space.html">design_space()</a></code> function for
this, specifying the lower and upper limits of the design variables in
the order they appear as simulation function arguments:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design_space</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/design_space.html">design_space</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>, </span>
<span>                             upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>                             sim <span class="op">=</span> <span class="va">sim_cRCT</span><span class="op">)</span></span>
<span></span>
<span><span class="va">design_space</span></span>
<span><span class="co">#&gt;   name lower upper</span></span>
<span><span class="co">#&gt; 1    m    10    50</span></span>
<span><span class="co">#&gt; 2    n     5    20</span></span></code></pre></div>
<p>Note that the function automatically retrieves the names of the
design variables based on the order they take in the simulation
function.</p>
<p>We also need to specify the hypotheses which we’re planning to
simulate under, using the <code><a href="../reference/hypotheses.html">hypotheses()</a></code> function, again
specifying in the order that parameters appear as simulation function
argument. We only need one hypothesis here, the alternative, since we
will be estimating the type II error rate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hypotheses.html">hypotheses</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.95</span>, <span class="fl">0.05</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                         hyp_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alt"</span><span class="op">)</span>,</span>
<span>                         sim <span class="op">=</span> <span class="va">sim_cRCT</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hypotheses</span></span>
<span><span class="co">#&gt;         alt</span></span>
<span><span class="co">#&gt; beta_1 0.30</span></span>
<span><span class="co">#&gt; var_e  0.95</span></span>
<span><span class="co">#&gt; var_u  0.05</span></span></code></pre></div>
<p>Constraints should be specified using the <code>constraints</code>
function. Each constraint should be named, and should be defined with
respect to a specific output and a specific hypothesis. It should have a
nominal maximum value, and a probability <code>delta</code> used to
judge if it is satisfied. Here, our constraint is that the mean of the
simulation output (i.e. the probability of a negative result) under the
<code>alt</code> hypothesis should be less than or equal to 0.2 with a
probability of at least 0.95. Finally, we note whether the constraint
output is binary or otherwise.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">constraints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/constraints.html">constraints</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"con_tII"</span><span class="op">)</span>,</span>
<span>                   out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span><span class="op">)</span>,</span>
<span>                   hyp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alt"</span><span class="op">)</span>,</span>
<span>                   nom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,</span>
<span>                   delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span>,</span>
<span>                   binary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">constraints</span></span>
<span><span class="co">#&gt;      name out hyp nom delta binary</span></span>
<span><span class="co">#&gt; 1 con_tII   s alt 0.2  0.95   TRUE</span></span></code></pre></div>
<p>The final ingredient of the problem is the set of objectives we want
to minimise. Similar to constraints, objectives are tied to a specific
output and hypothesis. We also specify weights for each objective which
help guide the internal optimisation process, and note whether or not
the output for each objective is binary or continuous. For example, here
we want to minimise both the number of patients <code>N</code> and the
number of clusters <code>m</code>, with the latter carrying a weight of
100 times that of the former.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">objectives</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/objectives.html">objectives</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"m"</span><span class="op">)</span>,</span>
<span>                 out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"m"</span><span class="op">)</span>,</span>
<span>                 hyp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alt"</span>, <span class="st">"alt"</span><span class="op">)</span>,</span>
<span>                 weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                 binary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">objectives</span></span>
<span><span class="co">#&gt;   name out hyp weight binary</span></span>
<span><span class="co">#&gt; 1    N   N alt      1  FALSE</span></span>
<span><span class="co">#&gt; 2    m   m alt     10  FALSE</span></span></code></pre></div>
<p>We now put this simulation function and set of data frames together
to create an object of class <code>BOSSS_problem</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BOSSS_problem.html">BOSSS_problem</a></span><span class="op">(</span><span class="va">sim_cRCT</span>, <span class="va">design_space</span>, <span class="va">hypotheses</span>, <span class="va">objectives</span>, <span class="va">constraints</span>, det_func <span class="op">=</span> <span class="va">det_cRCT</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="initialisation">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation"></a>
</h3>
<p>Having set up the problem, we now need to create an initial solution
to it. This involves setting up a space-filling set of designs spanning
the design space (where <code>size</code> is the number of designs),
computing the Monte Carlo estimates of all the expectations we are
interested in at each of these designs (using <code>N</code> samples for
each evaluation), fitting Gaussian Process models to these estimates,
and then using those models to estimate the Pareto set and front:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9823579</span><span class="op">)</span></span>
<span></span>
<span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BOSSS_solution.html">BOSSS_solution</a></span><span class="op">(</span><span class="va">size</span>, <span class="va">N</span>, <span class="va">prob</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking simulation speed...</span></span>
<span><span class="co">#&gt; Initialisation will take approximately 0.6058314 secs </span></span>
<span><span class="co">#&gt; Solution found</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Design variables for the Pareto set: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        m        n</span></span>
<span><span class="co">#&gt; 2  40.00  8.75000</span></span>
<span><span class="co">#&gt; 19 23.75 15.78125</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Corresponding objective function values... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    N, alt (mean) m, alt (mean)</span></span>
<span><span class="co">#&gt; 2            320            40</span></span>
<span><span class="co">#&gt; 19           345            23</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ...and constraint function values:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    s, alt (mean) s, alt (var)</span></span>
<span><span class="co">#&gt; 2      -2.419826   0.13279668</span></span>
<span><span class="co">#&gt; 19     -1.442005   0.06439835</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span></code></pre></div>
<p><img src="BOSSS_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> function will give a table of the Pareto set
with associated objective function values. The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function will plot the Pareto front.</p>
</div>
<div class="section level3">
<h3 id="iteration">Iteration<a class="anchor" aria-label="anchor" href="#iteration"></a>
</h3>
<p>We can now start improving this solution by calling the
<code><a href="../reference/iterate.html">iterate()</a></code> function. Each call uses the fitted Gaussian
Process models to decide on the next design to be evaluated, computes
the Monte Carlo estimates at that point, and then updates the estimated
Pareto set and front.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/iterate.html">iterate</a></span><span class="op">(</span><span class="va">sol</span>, <span class="va">prob</span>, <span class="va">N</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="co">#&gt; Design variables for the Pareto set: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           m         n</span></span>
<span><span class="co">#&gt; 19 23.75000 15.781250</span></span>
<span><span class="co">#&gt; 21 31.98561  8.998203</span></span>
<span><span class="co">#&gt; 23 26.99795 11.994627</span></span>
<span><span class="co">#&gt; 26 20.99459 19.989657</span></span>
<span><span class="co">#&gt; 28 24.99390 13.996301</span></span>
<span><span class="co">#&gt; 32 27.99674 10.982857</span></span>
<span><span class="co">#&gt; 36 35.96746  7.995976</span></span>
<span><span class="co">#&gt; 37 21.98949 17.999186</span></span>
<span><span class="co">#&gt; 39 29.72974  9.967550</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Corresponding objective function values... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    N, alt (mean) m, alt (mean)</span></span>
<span><span class="co">#&gt; 19           345            23</span></span>
<span><span class="co">#&gt; 21           248            31</span></span>
<span><span class="co">#&gt; 23           286            26</span></span>
<span><span class="co">#&gt; 26           380            20</span></span>
<span><span class="co">#&gt; 28           312            24</span></span>
<span><span class="co">#&gt; 32           270            27</span></span>
<span><span class="co">#&gt; 36           245            35</span></span>
<span><span class="co">#&gt; 37           357            21</span></span>
<span><span class="co">#&gt; 39           261            29</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ...and constraint function values:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    s, alt (mean) s, alt (var)</span></span>
<span><span class="co">#&gt; 19     -1.442005   0.06439835</span></span>
<span><span class="co">#&gt; 21     -1.507734   0.06711024</span></span>
<span><span class="co">#&gt; 23     -1.803428   0.08202314</span></span>
<span><span class="co">#&gt; 26     -1.317975   0.05979584</span></span>
<span><span class="co">#&gt; 28     -1.378841   0.06197353</span></span>
<span><span class="co">#&gt; 32     -1.576338   0.07015849</span></span>
<span><span class="co">#&gt; 36     -1.803428   0.08202314</span></span>
<span><span class="co">#&gt; 37     -1.803428   0.08202314</span></span>
<span><span class="co">#&gt; 39     -1.317975   0.05979584</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span></code></pre></div>
<p><img src="BOSSS_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We can compare the initial and final approximations to the Pareto
front to the actual front since, for this simple example, we can
calculate power analytically:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">50</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">N</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">m</span><span class="op">*</span><span class="va">df</span><span class="op">$</span><span class="va">n</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">clust_var</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="op">+</span> <span class="fl">0.95</span><span class="op">/</span><span class="va">df</span><span class="op">$</span><span class="va">n</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">pow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/power.t.test.html" class="external-link">power.t.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">m</span>, delta <span class="op">=</span> <span class="fl">0.3</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">clust_var</span><span class="op">)</span>,</span>
<span>                       alternative <span class="op">=</span> <span class="st">"one.sided"</span>, sig.level <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span><span class="op">$</span><span class="va">power</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">pow</span> <span class="op">&gt;=</span> <span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"N"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/mco/man/paretoFront.html" class="external-link">paretoFilter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="st">"True"</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">23</span>,</span>
<span>                                 <span class="fl">23</span>, <span class="fl">31</span>, <span class="fl">26</span>, <span class="fl">20</span>, <span class="fl">24</span>, <span class="fl">27</span>, <span class="fl">35</span>, <span class="fl">21</span>, <span class="fl">29</span><span class="op">)</span>,</span>
<span>                           N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">320</span>, <span class="fl">345</span>,</span>
<span>                                 <span class="fl">345</span>, <span class="fl">248</span>, <span class="fl">286</span>, <span class="fl">380</span>, <span class="fl">312</span>, <span class="fl">270</span>, <span class="fl">245</span>, <span class="fl">357</span>, <span class="fl">261</span><span class="op">)</span>,</span>
<span>                           t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Initial"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Final"</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add ends of steps</span></span>
<span><span class="va">df2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43</span>, <span class="fl">43</span><span class="op">)</span>,</span>
<span>                          N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">320</span>, <span class="fl">245</span><span class="op">)</span>,</span>
<span>                          t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Initial"</span>, <span class="st">"Final"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              <span class="va">df</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">23</span>, <span class="fl">20</span>, <span class="fl">19</span><span class="op">)</span>,</span>
<span>                         N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">380</span>, <span class="fl">380</span>, <span class="fl">380</span><span class="op">)</span>,</span>
<span>                         t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Initial"</span>, <span class="st">"Final"</span>, <span class="st">"True"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">m</span>, colour <span class="op">=</span> <span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Total sample size per arm, N"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Number of clusters per arm, m"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#EF476F"</span>, <span class="st">"#FFD166"</span>, <span class="st">"#06D6A0"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="BOSSS_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#ggsave(here("man", "figures", "cRCT_fronts.pdf"), height=9, width=14, units="cm")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h3>
<p>To check the GP models are giving sensible predictions, we can choose
a specific design and then plot the predictions for each model along the
range of each design variable.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pick a specific design from the Pareto set</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="va">sol</span><span class="op">$</span><span class="va">p_set</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diag_plots.html">diag_plots</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">prob</span>, <span class="va">sol</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="BOSSS_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#ggsave(here("man", "figures", "cRCT_diag_m.pdf"), height=8, width=8, units="cm")</span></span>
<span></span>
<span><span class="va">ps</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="BOSSS_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#ggsave(here("man", "figures", "cRCT_diag_n.pdf"), height=8, width=8, units="cm")</span></span></code></pre></div>
<p>We can also get the predicted values and 95% credible intervals for
each point we have evaluated, contrasting these with the empirical MC
estimate and interval. This will return a data frame for each of the
models, named according to the output-hypothesis combination which
defines it. We highlight with a <code>*</code> any points where the two
intervals do not overlap.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diag_predictions.html">diag_predictions</a></span><span class="op">(</span><span class="va">prob</span>, <span class="va">sol</span><span class="op">)</span></span>
<span><span class="va">dp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">dp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">no_overlap</span> <span class="op">==</span> <span class="st">"*"</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;    m      n    MC_mean     MC_l95    MC_u95    p_mean     p_l95     p_u95</span></span>
<span><span class="co">#&gt; 2 40  8.750 0.08167331 0.06415771 0.1034422 0.1310516 0.1084724 0.1575005</span></span>
<span><span class="co">#&gt; 4 25 10.625 0.18127490 0.16256478 0.2016200 0.2292782 0.2027420 0.2581629</span></span>
<span><span class="co">#&gt; 7 15 14.375 0.44023904 0.42081966 0.4598431 0.3599080 0.3110047 0.4119038</span></span>
<span><span class="co">#&gt;   no_overlap</span></span>
<span><span class="co">#&gt; 2          *</span></span>
<span><span class="co">#&gt; 4          *</span></span>
<span><span class="co">#&gt; 7          *</span></span></code></pre></div>
<p>In this example we see that the empirical estimates agree with the
predictions for all but three of the designs which have been
evaluated.</p>
<p>At any point, but especially after initialisation, we may decide that
we need more points in our initial evaluations, or more simulations at
each of those points. We can do that via <code><a href="../reference/extend_initial.html">extend_initial()</a></code>.
For example, suppose we want to add an extra 500 simulations to our
initial points and to add another ten points to the initial
space-filling design:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extend_initial.html">extend_initial</a></span><span class="op">(</span><span class="va">prob</span>, <span class="va">sol</span>, extra_N <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at the first three designs; the empirical and predicted estimates will have changed</span></span>
<span><span class="fu"><a href="../reference/diag_predictions.html">diag_predictions</a></span><span class="op">(</span><span class="va">prob</span>, <span class="va">sol</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;    m     n   MC_mean    MC_l95    MC_u95    p_mean     p_l95     p_u95</span></span>
<span><span class="co">#&gt; 1 30 12.50 0.1078739 0.1074902 0.1082588 0.1127607 0.1080320 0.1176691</span></span>
<span><span class="co">#&gt; 2 40  8.75 0.1098345 0.1094508 0.1102194 0.1080917 0.1025593 0.1138846</span></span>
<span><span class="co">#&gt; 3 20 16.25 0.2084542 0.2080702 0.2088388 0.2148734 0.2065514 0.2234364</span></span>
<span><span class="co">#&gt;   no_overlap</span></span>
<span><span class="co">#&gt; 1           </span></span>
<span><span class="co">#&gt; 2           </span></span>
<span><span class="co">#&gt; 3</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="co">#&gt; Design variables for the Pareto set: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           m         n</span></span>
<span><span class="co">#&gt; 19 23.75000 15.781250</span></span>
<span><span class="co">#&gt; 21 31.98561  8.998203</span></span>
<span><span class="co">#&gt; 25 34.99566  7.989802</span></span>
<span><span class="co">#&gt; 26 20.99459 19.989657</span></span>
<span><span class="co">#&gt; 27 25.99366 11.997557</span></span>
<span><span class="co">#&gt; 28 24.99390 13.996301</span></span>
<span><span class="co">#&gt; 30 39.84001  6.996653</span></span>
<span><span class="co">#&gt; 32 27.99674 10.982857</span></span>
<span><span class="co">#&gt; 37 21.98949 17.999186</span></span>
<span><span class="co">#&gt; 38 24.97926 12.984413</span></span>
<span><span class="co">#&gt; 39 29.72974  9.967550</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Corresponding objective function values... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    N, alt (mean) m, alt (mean)</span></span>
<span><span class="co">#&gt; 19           345            23</span></span>
<span><span class="co">#&gt; 21           248            31</span></span>
<span><span class="co">#&gt; 25           238            34</span></span>
<span><span class="co">#&gt; 26           380            20</span></span>
<span><span class="co">#&gt; 27           275            25</span></span>
<span><span class="co">#&gt; 28           312            24</span></span>
<span><span class="co">#&gt; 30           234            39</span></span>
<span><span class="co">#&gt; 32           270            27</span></span>
<span><span class="co">#&gt; 37           357            21</span></span>
<span><span class="co">#&gt; 38           288            24</span></span>
<span><span class="co">#&gt; 39           261            29</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ...and constraint function values:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    s, alt (mean) s, alt (var)</span></span>
<span><span class="co">#&gt; 19     -1.669745  0.001470298</span></span>
<span><span class="co">#&gt; 21     -1.507734  0.067110238</span></span>
<span><span class="co">#&gt; 25     -1.317975  0.059795836</span></span>
<span><span class="co">#&gt; 26     -1.317975  0.059795836</span></span>
<span><span class="co">#&gt; 27     -1.317975  0.059795836</span></span>
<span><span class="co">#&gt; 28     -1.378841  0.061973532</span></span>
<span><span class="co">#&gt; 30     -1.202247  0.056056593</span></span>
<span><span class="co">#&gt; 32     -1.576338  0.070158486</span></span>
<span><span class="co">#&gt; 37     -1.803428  0.082023137</span></span>
<span><span class="co">#&gt; 38     -1.317975  0.059795836</span></span>
<span><span class="co">#&gt; 39     -1.317975  0.059795836</span></span></code></pre></div>
<p>Or, we could add another 10 points:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extend_initial.html">extend_initial</a></span><span class="op">(</span><span class="va">prob</span>, <span class="va">sol</span>, extra_points <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at the added designs, which go to the top of the table</span></span>
<span><span class="fu"><a href="../reference/diag_predictions.html">diag_predictions</a></span><span class="op">(</span><span class="va">prob</span>, <span class="va">sol</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;        m        n    MC_mean     MC_l95     MC_u95     p_mean      p_l95</span></span>
<span><span class="co">#&gt; 21 48.75 13.90625 0.01356756 0.01318861 0.01395726 0.01334306 0.01138131</span></span>
<span><span class="co">#&gt; 22 38.75 10.15625 0.06964160 0.06925830 0.07002686 0.07665655 0.07267431</span></span>
<span><span class="co">#&gt; 23 18.75 17.65625 0.23002117 0.22963712 0.23040568 0.22607536 0.21769971</span></span>
<span><span class="co">#&gt; 24 16.25  7.34375 0.52137087 0.52098658 0.52175514 0.52371973 0.51071445</span></span>
<span><span class="co">#&gt; 25 36.25 14.84375 0.04356521 0.04318255 0.04395111 0.04246471 0.03952891</span></span>
<span><span class="co">#&gt; 26 46.25 11.09375 0.02925261 0.02887077 0.02963934 0.03110227 0.02813903</span></span>
<span><span class="co">#&gt; 27 26.25 18.59375 0.08787546 0.08749194 0.08826050 0.09192164 0.08644759</span></span>
<span><span class="co">#&gt; 28 21.25  9.21875 0.33550310 0.33511893 0.33588748 0.34737802 0.33927408</span></span>
<span><span class="co">#&gt; 29 41.25 16.71875 0.01905733 0.01867683 0.01944543 0.01836489 0.01668195</span></span>
<span><span class="co">#&gt; 30 31.25  5.46875 0.33785585 0.33747169 0.33824024 0.33934765 0.32739678</span></span>
<span><span class="co">#&gt;         p_u95 no_overlap</span></span>
<span><span class="co">#&gt; 21 0.01563759           </span></span>
<span><span class="co">#&gt; 22 0.08083798          *</span></span>
<span><span class="co">#&gt; 23 0.23467659           </span></span>
<span><span class="co">#&gt; 24 0.53669292           </span></span>
<span><span class="co">#&gt; 25 0.04560820           </span></span>
<span><span class="co">#&gt; 26 0.03436652           </span></span>
<span><span class="co">#&gt; 27 0.09770525           </span></span>
<span><span class="co">#&gt; 28 0.35557136          *</span></span>
<span><span class="co">#&gt; 29 0.02021413           </span></span>
<span><span class="co">#&gt; 30 0.35150677</span></span></code></pre></div>
<p>Once we are happy with our solution and have chosen a specific design
from the Pareto set, we might want to double check that point by running
a large number of simulations at it.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="va">sol</span><span class="op">$</span><span class="va">p_set</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sol</span><span class="op">$</span><span class="va">p_set</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diag_check_point.html">diag_check_point</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">prob</span>, <span class="va">sol</span>, N<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Model 1 prediction interval: [0.161, 0.176]</span></span>
<span><span class="co">#&gt; Model 1 empirical interval: [0.187, 0.189]</span></span></code></pre></div>
<p>If we decide we want to run more simulations at the same point, we
can pass the previous results in so they are built upon.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diag_check_point.html">diag_check_point</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">prob</span>, <span class="va">sol</span>, N<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span>, <span class="va">r</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Model 1 prediction interval: [0.161, 0.176]</span></span>
<span><span class="co">#&gt; Model 1 empirical interval: [0.187, 0.189]</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Duncan Wilson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
