# Some helper functions to create the four data frames which partly specify
# the problem.


#' Create a design space
#'
#' @param name optional character vector of design variable names.
#' @param sim optional simulation function.
#' @param lower numeric vector of lower limits.
#' @param upper numeric vector of upper limits.
#'
#' @return A data.frame defining the design space.
#' @export
#'
#'
design_space <- function(name = NULL, sim = NULL, lower, upper) {

  if(is.null(name)){
    dim <- length(lower)
    if(is.null(sim)){
      stop(
        "name or sim must be specified.",
        call. = FALSE
      )
    }
    name <- formalArgs(sim)[1:dim]
  }

  stopifnot(upper > lower)

  data.frame(name = name,
             lower = lower,
             upper = upper)
}


#' Create a set of hypotheses
#'
#' @param par_name optional character vector of model parameter names.
#' @param sim optional simulation function.
#' @param values numeric matrix, each column giving the model parameter
#' values under a specific hypothesis.
#' @param hyp_names character vector of hypothesis names.
#'
#' @return A data.frame defining the hypotheses.
#' @export
#'
#'
hypotheses <- function(par_name = NULL, sim = NULL, values, hyp_names) {

  if(is.null(par_name)){
    dim <- nrow(values)
    if(is.null(sim)){
      stop(
        "parname or sim must be specified.",
        call. = FALSE
      )
    }
    num_args <- length(formalArgs(sim))
    par_name <- formalArgs(sim)[(num_args - dim + 1):num_args]
  }

  df <- data.frame(v = values)
  row.names(df) <- par_name
  names(df) <- hyp_names
  df
}


#' Create a set of constraints
#'
#' @param name character vector of constraint names.
#' @param out character vector denoting which simulation output each constraint
#' pertains to.
#' @param hyp character vector denoting which hypothesis each constraint
#' pertains to.
#' @param nom numeric vector of nominal upper limits.
#' @param delta numeric vector of probabilities.
#' @param stoch boolean vector denoting if the constraint function is stochastic
#' (TRUE) or deterministic (FALSE).
#'
#' @return A data.frame defining the constraints.
#' @export
#'
#'
constraints <- function(name, out, hyp, nom, delta, stoch) {

  data.frame(name = name,
             out = out,
             hyp = hyp,
             nom = nom,
             delta = delta,
             stoch = stoch)
}


#' Create a set of objectives
#'
#' @param name character vector of objective names.
#' @param out character vector denoting which simulation output each objective
#' pertains to.
#' @param hyp character vector denoting which hypothesis each objective
#' pertains to.
#' @param weight numeric vector of weights assigned to each objective.
#' @param stoch boolean vector denoting if the objective function is stochastic
#' (TRUE) or deterministic (FALSE).
#' @param binary boolean vector denoting if the output of the objective
#' function is binary (TRUE) or continuous (FALSE).
#'
#' @return A data.frame defining the objectives.
#' @export
#'
#'
objectives <- function(name, out, hyp, weight, stoch, binary) {

  data.frame(name = name,
             out = out,
             hyp = hyp,
             weight = weight,
             stoch = stoch,
             binary = binary)
}
